<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Planning Journey</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #045174;
            min-height: 100vh;
            padding: 0;
        }

        /* Navigation Bar */
        .navbar {
            background: #045174;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .logo-link {
            display: flex;
            align-items: center;
        }

        .logo {
            height: 50px;
            width: auto;
        }

        .nav-links {
            display: flex;
            gap: 35px;
            align-items: center;
            list-style: none;
        }

        .nav-links a {
            color: #f8dcbf;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 8px 16px;
            border-radius: 5px;
        }

        .nav-links a:hover {
            color: #d4af37;
            background: rgba(248, 220, 191, 0.1);
        }

        .main-content {
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 30px;
        }

        /* Progress Tracker */
        .progress-tracker {
            width: 280px;
            background: white;
            border-radius: 15px;
            padding: 25px 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 20px;
            height: fit-content;
            max-height: 90vh;
            overflow-y: auto;
        }

        .client-info-section {
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
        }

        .action-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .save-btn {
            background: #4CAF50;
            color: white;
        }

        .save-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .export-btn {
            background: #2196F3;
            color: white;
        }

        .export-btn:hover {
            background: #0b7dda;
            transform: translateY(-2px);
        }

        .import-btn {
            background: #FF9800;
            color: white;
        }

        .import-btn:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }

        .progress-header {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .progress-bar-container {
            background: #e9ecef;
            height: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-bar-fill {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .progress-percentage {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .progress-percentage br {
            display: block;
            content: "";
            margin-top: 5px;
        }

        .progress-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .progress-item:hover {
            background: #f8f9fa;
        }

        .progress-item.completed {
            background: #e8f5e9;
        }

        .progress-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #4CAF50;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .progress-checkbox.checked::after {
            content: "‚úì";
            color: #4CAF50;
            font-weight: bold;
            font-size: 14px;
        }

        .progress-label {
            font-size: 14px;
            color: #495057;
        }

        /* Flowchart Area */
        .flowchart-area {
            flex: 1;
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .flowchart-title {
            font-size: 32px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 40px;
            text-align: center;
        }

        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
        }

        .flow-container-horizontal {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            gap: 60px;
            justify-content: center;
        }

        .branch-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .side-branch-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .branch-split {
            display: flex;
            align-items: flex-start;
            gap: 30px;
            margin-top: 0;
            width: 100%;
            justify-content: center;
        }

        .horizontal-arrow {
            font-size: 40px;
            color: #3498db;
            margin-top: 20px;
            font-weight: bold;
        }

        .side-branch {
            border-left: 3px solid #3498db;
            padding-left: 30px;
        }

        .flow-node {
            background: white;
            border: 3px solid #3498db;
            border-radius: 12px;
            padding: 25px 40px;
            min-width: 280px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .flow-node:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            border-color: #2980b9;
        }

        .flow-node.completed {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-color: #4CAF50;
        }

        .flow-node-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .flow-node-subtitle {
            font-size: 14px;
            color: #7f8c8d;
        }

        .flow-node-buttons {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .node-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .btn-notes {
            background: #3498db;
            color: white;
        }

        .btn-notes:hover {
            background: #2980b9;
        }

        .btn-link {
            background: #95a5a6;
            color: white;
        }

        .btn-link:hover {
            background: #7f8c8d;
        }

        .btn-complete {
            background: #4CAF50;
            color: white;
        }

        .btn-complete:hover {
            background: #45a049;
        }

        .btn-incomplete {
            background: #e74c3c;
            color: white;
        }

        .btn-incomplete:hover {
            background: #c0392b;
        }

        .flow-arrow {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid #3498db;
            margin: 10px 0;
        }

        .flow-row {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .flow-horizontal-arrow {
            font-size: 30px;
            color: #3498db;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.3s;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            padding: 25px 30px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
        }

        .close {
            color: white;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
            transition: all 0.3s ease;
        }

        .close:hover {
            transform: scale(1.2);
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 13px;
        }

        .form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #3498db;
        }

        select.form-input {
            cursor: pointer;
        }

        textarea.form-input {
            min-height: 150px;
            resize: vertical;
            font-family: inherit;
        }

        .modal-footer {
            padding: 20px 30px;
            background: #f8f9fa;
            border-radius: 0 0 15px 15px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn-save {
            padding: 12px 30px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-save:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-cancel {
            padding: 12px 30px;
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-cancel:hover {
            background: #7f8c8d;
        }

        .completion-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #4CAF50;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.4);
        }

        .file-count-badge {
            position: absolute;
            top: -10px;
            left: -10px;
            background: #2196F3;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.4);
        }

        .file-upload-hint {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        .file-list {
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 10px;
        }

        .no-files {
            text-align: center;
            color: #95a5a6;
            padding: 20px;
            font-style: italic;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .file-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .file-icon {
            font-size: 24px;
        }

        .file-details {
            flex: 1;
        }

        .file-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
            margin-bottom: 3px;
        }

        .file-meta {
            font-size: 12px;
            color: #7f8c8d;
        }

        .file-actions {
            display: flex;
            gap: 5px;
        }

        .file-btn {
            padding: 6px 10px;
            border: none;
            border-radius: 5px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .view-btn {
            background: #3498db;
            color: white;
        }

        .view-btn:hover {
            background: #2980b9;
        }

        .download-btn {
            background: #27ae60;
            color: white;
        }

        .download-btn:hover {
            background: #229954;
        }

        .delete-btn {
            background: #e74c3c;
            color: white;
        }

        .delete-btn:hover {
            background: #c0392b;
        }

        .main-flow-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Footer */
        .footer {
            background: #034561;
            color: #f8dcbf;
            padding: 40px 20px 20px;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
            margin-bottom: 30px;
        }

        .footer-section h3 {
            color: #d4af37;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .footer-section p,
        .footer-section a {
            color: #f8dcbf;
            line-height: 1.8;
            font-size: 14px;
            text-decoration: none;
        }

        .footer-section a:hover {
            color: #d4af37;
        }

        .footer-links {
            list-style: none;
            padding: 0;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-bottom {
            border-top: 1px solid rgba(248, 220, 191, 0.2);
            padding-top: 20px;
            text-align: center;
            color: #f8dcbf;
            font-size: 13px;
        }

        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 15px;
                padding: 15px 20px;
            }

            .nav-links {
                flex-direction: column;
                gap: 10px;
                width: 100%;
            }

            .nav-links a {
                width: 100%;
                text-align: center;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .progress-tracker {
                width: 100%;
                position: relative;
                top: 0;
            }

            .flow-container-horizontal {
                flex-direction: column;
                gap: 30px;
            }

            .file-actions {
                flex-direction: column;
            }

            .file-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .flow-row {
                flex-direction: column;
            }

            .flow-horizontal-arrow {
                transform: rotate(90deg);
            }

            .navbar {
                flex-direction: column;
                gap: 15px;
                padding: 15px 20px;
            }

            .nav-links {
                flex-direction: column;
                gap: 10px;
                width: 100%;
            }

            .nav-links a {
                width: 100%;
                text-align: center;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <a href="https://mylocalfiduciary.com" class="logo-link">
            <img src="data:image/webp;base64,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" class="logo" alt="My Local Fiduciary">
        </a>
        <ul class="nav-links">
            <li><a href="https://mylocalfiduciary.com/progress">Progress</a></li>
            <li><a href="https://mylocalfiduciary.com/riskradius">Risk Radius</a></li>
            <li><a href="https://mylocalfiduciary.com/journey">Journey</a></li>
            <li><a href="https://mylocalfiduciary.com/cashflowengine">Cashflow Engine</a></li>
        </ul>
    </nav>

    <div class="main-content">
    <div class="container">
        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="client-info-section">
                <h3 class="section-title">Client Information</h3>
                <div class="form-group">
                    <label class="form-label">Client Name</label>
                    <input type="text" class="form-input" id="clientName" placeholder="Enter client name">
                </div>
                <div class="form-group" id="clientName2Group" style="display: none;">
                    <label class="form-label">Client Name 2</label>
                    <input type="text" class="form-input" id="clientName2" placeholder="Enter second client name">
                </div>
                <div class="form-group">
                    <label class="form-label">Client Type</label>
                    <select class="form-input" id="clientType">
                        <option value="individual">Individual</option>
                        <option value="couple">Couple</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" class="form-input" id="clientDate">
                </div>
            </div>

            <div class="divider"></div>

            <div class="progress-header">Journey Progress</div>
            <div class="progress-percentage">üöÄ<br>0%</div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill"></div>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn save-btn" id="saveProgressBtn">üíæ Save Progress</button>
                <button class="action-btn export-btn" id="exportBtn">üì§ Export</button>
                <button class="action-btn import-btn" id="importBtn">üì• Import</button>
                <input type="file" id="importFile" accept=".json" style="display: none;">
            </div>

            <div class="divider"></div>

            <div id="progressList"></div>
        </div>

        <!-- Flowchart -->
        <div class="flowchart-area">
            <h1 class="flowchart-title">Financial Planning Journey</h1>
            <div class="flowchart" id="flowchart"></div>
        </div>
    </div>

    <!-- Modal -->
    <div id="notesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title" id="modalTitle">Add Notes</span>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">External Link (Optional)</label>
                    <input type="url" class="form-input" id="externalLink" placeholder="https://example.com/resource">
                </div>
                <div class="form-group">
                    <label class="form-label">Notes</label>
                    <textarea class="form-input" id="notesText" placeholder="Add notes for this step..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Upload Files (PDF, Excel, Images)</label>
                    <input type="file" class="form-input" id="fileUpload" multiple accept=".pdf,.xlsx,.xls,.jpg,.jpeg,.png,.gif">
                    <div class="file-upload-hint">You can upload multiple files at once</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Uploaded Files</label>
                    <div id="fileList" class="file-list"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" id="cancelBtn">Cancel</button>
                <button class="btn-save" id="saveBtn">Save</button>
            </div>
        </div>
    </div>

    <script>
        // Data structure for flowchart
        const flowData = [
            {
                id: 'cashflow-worksheet',
                title: 'Cashflow Worksheet',
                subtitle: 'In + Out',
                completed: false,
                notes: '',
                link: '',
                branch: 'main',
                files: []
            },
            {
                id: 'your-radius',
                title: 'Your Radius',
                subtitle: 'Where We Are Going',
                completed: false,
                notes: '',
                link: '',
                branch: 'main',
                files: []
            },
            {
                id: 'risk-radius',
                title: 'Risk Radius‚Ñ¢',
                subtitle: 'How & Why?',
                completed: false,
                notes: '',
                link: '',
                branch: 'main',
                files: []
            },
            {
                id: 'efficiency-matrix',
                title: 'Efficiency Matrix',
                subtitle: 'Risk/Tax Distribution Magic',
                completed: false,
                notes: '',
                link: '',
                branch: 'main',
                files: []
            },
            {
                id: 'cashflow-engine',
                title: 'Cashflow Engine',
                subtitle: 'Find Your Zero - Where Money Should Flow',
                completed: false,
                notes: '',
                link: '',
                branch: 'side',
                files: []
            },
            {
                id: '5-year-journey',
                title: '5 Year Journey',
                subtitle: 'Portfolio Trajectory',
                completed: false,
                notes: '',
                link: '',
                branch: 'side',
                files: []
            },
            {
                id: 'annual-report',
                title: 'Annual Report',
                subtitle: '',
                completed: false,
                notes: '',
                link: '',
                branch: 'side',
                files: []
            },
            {
                id: 'distribution-qs',
                title: 'Distribution Q\'s',
                subtitle: 'When Needed',
                completed: false,
                notes: '',
                link: '',
                branch: 'side',
                files: []
            }
        ];

        // Client information
        let clientInfo = {
            name: '',
            name2: '',
            clientType: 'individual',
            date: new Date().toISOString().split('T')[0]
        };

        let currentNodeId = null;

        // Load saved data from localStorage
        function loadSavedData() {
            const saved = localStorage.getItem('financialFlowData');
            if (saved) {
                const savedData = JSON.parse(saved);
                savedData.forEach((savedNode, index) => {
                    if (flowData[index]) {
                        flowData[index].completed = savedNode.completed;
                        flowData[index].notes = savedNode.notes;
                        flowData[index].link = savedNode.link;
                        flowData[index].files = savedNode.files || [];
                    }
                });
            }
            
            const savedClient = localStorage.getItem('clientInfo');
            if (savedClient) {
                clientInfo = JSON.parse(savedClient);
                document.getElementById('clientName').value = clientInfo.name;
                document.getElementById('clientName2').value = clientInfo.name2 || '';
                document.getElementById('clientType').value = clientInfo.clientType;
                document.getElementById('clientDate').value = clientInfo.date;
                toggleClientName2Visibility();
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('financialFlowData', JSON.stringify(flowData));
            localStorage.setItem('clientInfo', JSON.stringify(clientInfo));
        }

        // Save client info
        function saveClientInfo() {
            clientInfo.name = document.getElementById('clientName').value;
            clientInfo.name2 = document.getElementById('clientName2').value;
            clientInfo.clientType = document.getElementById('clientType').value;
            clientInfo.date = document.getElementById('clientDate').value;
            toggleClientName2Visibility();
            saveData();
        }

        // Toggle second client name field visibility
        function toggleClientName2Visibility() {
            const name2Group = document.getElementById('clientName2Group');
            if (clientInfo.clientType === 'couple') {
                name2Group.style.display = 'block';
            } else {
                name2Group.style.display = 'none';
            }
        }

        // Initialize
        function init() {
            loadSavedData();
            renderFlowchart();
            renderProgressTracker();
            updateProgress();
            setupModalHandlers();
        }

        // Render flowchart
        function renderFlowchart() {
            const flowchart = document.getElementById('flowchart');
            flowchart.innerHTML = '';

            // Main branch nodes
            const mainBranch = flowData.filter(node => node.branch === 'main');
            const sideBranch = flowData.filter(node => node.branch === 'side');

            const flowContainer = document.createElement('div');
            flowContainer.className = 'flow-container-horizontal';

            // Create main branch
            const mainContainer = document.createElement('div');
            mainContainer.className = 'branch-container';
            
            mainBranch.forEach((node, index) => {
                const nodeDiv = createNodeElement(node);
                mainContainer.appendChild(nodeDiv);

                // Add arrow after all nodes except the last
                if (index < mainBranch.length - 1) {
                    const arrow = document.createElement('div');
                    arrow.className = 'flow-arrow';
                    mainContainer.appendChild(arrow);
                }
            });

            flowContainer.appendChild(mainContainer);

            // Create side branch next to main branch
            if (sideBranch.length > 0) {
                const sideContainer = document.createElement('div');
                sideContainer.className = 'branch-container side-branch-container';
                
                sideBranch.forEach((node, index) => {
                    const nodeDiv = createNodeElement(node);
                    sideContainer.appendChild(nodeDiv);

                    if (index < sideBranch.length - 1) {
                        const arrow = document.createElement('div');
                        arrow.className = 'flow-arrow';
                        sideContainer.appendChild(arrow);
                    }
                });

                flowContainer.appendChild(sideContainer);
            }

            flowchart.appendChild(flowContainer);
        }

        // Create node element
        function createNodeElement(node) {
            const nodeDiv = document.createElement('div');
            nodeDiv.className = `flow-node ${node.completed ? 'completed' : ''}`;
            nodeDiv.id = node.id;

            const fileCount = node.files ? node.files.length : 0;
            const fileIndicator = fileCount > 0 ? `<span class="file-count-badge">${fileCount} üìé</span>` : '';

            nodeDiv.innerHTML = `
                ${node.completed ? '<div class="completion-badge">‚úì</div>' : ''}
                ${fileIndicator}
                <div class="flow-node-title">${node.title}</div>
                ${node.subtitle ? `<div class="flow-node-subtitle">${node.subtitle}</div>` : ''}
                <div class="flow-node-buttons">
                    <button class="node-btn btn-notes" onclick="openNotesModal('${node.id}')">üìù Notes</button>
                    ${node.link ? `<button class="node-btn btn-link" onclick="window.open('${node.link}', '_blank')">üîó Link</button>` : ''}
                    <button class="node-btn ${node.completed ? 'btn-incomplete' : 'btn-complete'}" onclick="toggleComplete('${node.id}')">
                        ${node.completed ? '‚Ü©Ô∏è Undo' : '‚úì Complete'}
                    </button>
                </div>
            `;

            return nodeDiv;
        }

        // Render progress tracker
        function renderProgressTracker() {
            const progressList = document.getElementById('progressList');
            progressList.innerHTML = '';

            flowData.forEach(node => {
                const item = document.createElement('div');
                item.className = `progress-item ${node.completed ? 'completed' : ''}`;
                item.onclick = () => scrollToNode(node.id);

                item.innerHTML = `
                    <div class="progress-checkbox ${node.completed ? 'checked' : ''}"></div>
                    <div class="progress-label">${node.title}</div>
                `;

                progressList.appendChild(item);
            });
        }

        // Update progress percentage
        function updateProgress() {
            const completedCount = flowData.filter(node => node.completed).length;
            const percentage = Math.round((completedCount / flowData.length) * 100);
            const emoji = getProgressEmoji();

            document.querySelector('.progress-percentage').innerHTML = `${emoji}<br>${percentage}%`;
            document.querySelector('.progress-bar-fill').style.width = `${percentage}%`;
        }

        // Scroll to node
        function scrollToNode(nodeId) {
            const element = document.getElementById(nodeId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                element.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    element.style.transform = 'scale(1)';
                }, 300);
            }
        }

        // Toggle completion status
        function toggleComplete(nodeId) {
            const node = flowData.find(n => n.id === nodeId);
            if (node) {
                node.completed = !node.completed;
                saveData();
                renderFlowchart();
                renderProgressTracker();
                updateProgress();
            }
        }

        // Open notes modal
        function openNotesModal(nodeId) {
            currentNodeId = nodeId;
            const node = flowData.find(n => n.id === nodeId);

            if (node) {
                document.getElementById('modalTitle').textContent = node.title;
                document.getElementById('notesText').value = node.notes || '';
                document.getElementById('externalLink').value = node.link || '';
                renderFileList();
                document.getElementById('notesModal').style.display = 'block';
            }
        }

        // Close notes modal
        function closeNotesModal() {
            document.getElementById('notesModal').style.display = 'none';
            currentNodeId = null;
        }

        // Save notes
        function saveNotes() {
            if (currentNodeId) {
                const node = flowData.find(n => n.id === currentNodeId);
                if (node) {
                    node.notes = document.getElementById('notesText').value;
                    node.link = document.getElementById('externalLink').value;
                    saveData();
                    renderFlowchart();
                    closeNotesModal();
                }
            }
        }

        // Handle file upload
        function handleFileUpload(event) {
            const files = event.target.files;
            if (!files || files.length === 0 || !currentNodeId) return;

            const node = flowData.find(n => n.id === currentNodeId);
            if (!node) return;

            if (!node.files) node.files = [];

            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    node.files.push({
                        name: file.name,
                        type: file.type,
                        size: file.size,
                        data: e.target.result,
                        uploadDate: new Date().toISOString()
                    });
                    saveData();
                    renderFileList();
                    renderFlowchart();
                };
                reader.readAsDataURL(file);
            });

            event.target.value = '';
        }

        // Render file list in modal
        function renderFileList() {
            const fileListContainer = document.getElementById('fileList');
            if (!currentNodeId) return;

            const node = flowData.find(n => n.id === currentNodeId);
            if (!node || !node.files || node.files.length === 0) {
                fileListContainer.innerHTML = '<p class="no-files">No files uploaded yet</p>';
                return;
            }

            fileListContainer.innerHTML = node.files.map((file, index) => `
                <div class="file-item">
                    <div class="file-info">
                        <span class="file-icon">${getFileIcon(file.type)}</span>
                        <div class="file-details">
                            <div class="file-name">${file.name}</div>
                            <div class="file-meta">${formatFileSize(file.size)} ‚Ä¢ ${new Date(file.uploadDate).toLocaleDateString()}</div>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="file-btn view-btn" onclick="viewFile(${index})">üëÅÔ∏è View</button>
                        <button class="file-btn download-btn" onclick="downloadFile(${index})">‚¨áÔ∏è Download</button>
                        <button class="file-btn delete-btn" onclick="deleteFile(${index})">üóëÔ∏è Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Get file icon based on type
        function getFileIcon(type) {
            if (type.includes('pdf')) return 'üìÑ';
            if (type.includes('image')) return 'üñºÔ∏è';
            if (type.includes('excel') || type.includes('spreadsheet')) return 'üìä';
            if (type.includes('word') || type.includes('document')) return 'üìù';
            return 'üìé';
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        // View file
        function viewFile(fileIndex) {
            if (!currentNodeId) return;
            const node = flowData.find(n => n.id === currentNodeId);
            if (!node || !node.files[fileIndex]) return;

            const file = node.files[fileIndex];
            const newWindow = window.open();
            
            if (file.type.includes('image')) {
                newWindow.document.write(`<img src="${file.data}" style="max-width:100%;">`);
            } else if (file.type.includes('pdf')) {
                newWindow.document.write(`<iframe src="${file.data}" width="100%" height="100%" style="border:none;"></iframe>`);
            } else {
                // For other file types, trigger download
                downloadFile(fileIndex);
                newWindow.close();
            }
        }

        // Download file
        function downloadFile(fileIndex) {
            if (!currentNodeId) return;
            const node = flowData.find(n => n.id === currentNodeId);
            if (!node || !node.files[fileIndex]) return;

            const file = node.files[fileIndex];
            const link = document.createElement('a');
            link.href = file.data;
            link.download = file.name;
            link.click();
        }

        // Delete file
        function deleteFile(fileIndex) {
            if (!currentNodeId) return;
            if (!confirm('Are you sure you want to delete this file?')) return;

            const node = flowData.find(n => n.id === currentNodeId);
            if (!node || !node.files[fileIndex]) return;

            node.files.splice(fileIndex, 1);
            saveData();
            renderFileList();
            renderFlowchart();
        }

        // Setup modal handlers
        function setupModalHandlers() {
            document.querySelector('.close').onclick = closeNotesModal;
            document.getElementById('cancelBtn').onclick = closeNotesModal;
            document.getElementById('saveBtn').onclick = saveNotes;

            window.onclick = function(event) {
                const modal = document.getElementById('notesModal');
                if (event.target === modal) {
                    closeNotesModal();
                }
            };

            // File upload handler
            document.getElementById('fileUpload').addEventListener('change', handleFileUpload);

            // Client info handlers
            document.getElementById('clientName').addEventListener('input', saveClientInfo);
            document.getElementById('clientName2').addEventListener('input', saveClientInfo);
            document.getElementById('clientType').addEventListener('change', saveClientInfo);
            document.getElementById('clientDate').addEventListener('change', saveClientInfo);

            // Save progress button
            document.getElementById('saveProgressBtn').onclick = function() {
                saveData();
                alert('Progress saved successfully!');
            };

            // Export button
            document.getElementById('exportBtn').onclick = function() {
                const exportData = {
                    flowData: flowData,
                    clientInfo: clientInfo,
                    exportDate: new Date().toISOString()
                };
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                const clientNames = clientInfo.clientType === 'couple' && clientInfo.name2
                    ? `${clientInfo.name.replace(/\s+/g, '-')}-${clientInfo.name2.replace(/\s+/g, '-')}`
                    : clientInfo.name.replace(/\s+/g, '-') || 'export';
                link.download = `financial-plan-${clientNames}-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
            };

            // Import button
            document.getElementById('importBtn').onclick = function() {
                document.getElementById('importFile').click();
            };

            document.getElementById('importFile').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        try {
                            const importData = JSON.parse(event.target.result);
                            if (importData.flowData && importData.clientInfo) {
                                importData.flowData.forEach((node, index) => {
                                    if (flowData[index]) {
                                        flowData[index].completed = node.completed;
                                        flowData[index].notes = node.notes;
                                        flowData[index].link = node.link;
                                        flowData[index].files = node.files || [];
                                    }
                                });
                                clientInfo = importData.clientInfo;
                                saveData();
                                location.reload();
                            } else {
                                alert('Invalid file format');
                            }
                        } catch (error) {
                            alert('Error importing file: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                }
                e.target.value = '';
            });
        }

        // Get progress emoji based on completion
        function getProgressEmoji() {
            const percentage = getProgressPercentage();
            if (percentage === 0) return 'üöÄ'; // Starting
            if (percentage < 25) return 'üòä'; // Just started
            if (percentage < 50) return 'üòÑ'; // Making progress
            if (percentage < 75) return 'üéâ'; // Good progress
            if (percentage < 100) return 'üåü'; // Almost there
            return 'üèÜ'; // Complete!
        }

        function getProgressPercentage() {
            const completedCount = flowData.filter(node => node.completed).length;
            return Math.round((completedCount / flowData.length) * 100);
        }

        // Initialize on page load
        window.onload = init;
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>About My Local Fiduciary</h3>
                <p>Your trusted partner in comprehensive financial planning. We provide personalized strategies to help you achieve your financial goals with confidence and clarity.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="https://mylocalfiduciary.com/progress">Progress Tracker</a></li>
                    <li><a href="https://mylocalfiduciary.com/riskradius">Risk Radius‚Ñ¢</a></li>
                    <li><a href="https://mylocalfiduciary.com/journey">5 Year Journey</a></li>
                    <li><a href="https://mylocalfiduciary.com/cashflowengine">Cashflow Engine</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Resources</h3>
                <ul class="footer-links">
                    <li><a href="https://mylocalfiduciary.com/about">About Us</a></li>
                    <li><a href="https://mylocalfiduciary.com/services">Services</a></li>
                    <li><a href="https://mylocalfiduciary.com/blog">Blog</a></li>
                    <li><a href="https://mylocalfiduciary.com/contact">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Contact</h3>
                <ul class="footer-links">
                    <li><a href="mailto:info@mylocalfiduciary.com">info@mylocalfiduciary.com</a></li>
                    <li><a href="tel:+1234567890">(123) 456-7890</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 My Local Fiduciary. All rights reserved. | <a href="https://mylocalfiduciary.com/privacy" style="color: #d4af37;">Privacy Policy</a> | <a href="https://mylocalfiduciary.com/terms" style="color: #d4af37;">Terms of Service</a></p>
        </div>
    </footer>
</body>
</html>
